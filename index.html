<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Text</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="x-ua-compatible" content="IE=10">

    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/summernote/0.6.4/summernote.css">
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.0.3/css/font-awesome.min.css">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
    <script src="http://netdna.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <style type="text/css">
        .player
        {
        width: 5px;
        height: 20px;
        position: absolute;
        z-index: 99999999;
        }
    </style>
    <script type="text/javascript">
      var nombredoc = "Omnilaze";
    </script>
  </head>
<body>
<div class="container-fluid">

    <div class="navbar navbar-inverse">
      <div class="navbar-header">
        <a class="navbar-brand" href="#">Archivo tipo texto</a>
      </div>
    </div>
    <!-- Fin navbar -->
    <input type="text" id="nombre" value="File name..."><a id="save" onclick="myFunction()">Save</a>
    <div class="row">
      <div class="col-md-10">
         <textarea name="summernote" id="summernote"></textarea>
      </div>
      <!-- FIN texto -->
      <div class="col-md-2" style="background-color:lightblue;">
        <table>
        <tr id="usersconected">
          <td>
            <h4>Usuarios Conectados:</h4>
            <ul id="nombres">
              <li>Ejemplo</li>
            </ul>
            <hr>
          </td>
        </tr>
        <tr id="todolist">
          <td>
            <h4>To do list</h4>
            Explaining<br>
            Me
            <hr>
          </td>
        </tr>
        <tr id="chat">
          <td>
            <h4>Chat</h4>
            Hola
          </td>
        </tr>
        </table>
      </div>
      <!-- FIN Datos -->
    </div>
    <!-- Fin row -->
</div>
<div id="original">
</div>
    <script>
    </script>
    
<script src="/socket.io/socket.io.js"></script>
<script>

  var socket = io.connect("http://localhost");

  //INICIO - mouse tracker
  $("body").mousemove(function(event){
    var pos = {
      x: event.pageX,
      y: event.pageY
    };
    socket.emit('update_coords', pos);
  });

    socket.on('send_data', function(data){
    var i=0;
    var player = 0;
    while(i < data.length)
    {
      var le = data[i].x + 1;
      var me = '';
      if( data[i].id == pl.id ) me = 'You';
      player = '<div class="player" id="p_' + data[i].id + '" style="background: ' + data[i].color + '  ;left:' + le + 'px;top:' + data[i].y +'px"> ' + me + '</div>';
      $('#p_' + data[i].id).remove();
      $('body').append(player);
      i++;
    }
  });

    var name = 'User' + Math.round(Math.random() * 255);
      var r = Math.round(Math.random() * 255);
      var g = Math.round(Math.random() * 255);
      var b = Math.round(Math.random() * 255);
      var cl = 'rgb('+r+','+g+','+b+')';
      if(name == '') name = 'Anonymous';
      var pl = 
      {
        id: 0,
        name: name,
        color: cl,
        x: 0,
        y: 0
      };
      socket.on('connect', function () {
        socket.emit('client_connected', pl);
      });
  //FIN - mouse tracker
</script>
<script src="http://omnilaze.com/new/FileSaver/FileSaver.js"></script>
<script src="http://omnilaze.com/new/WordExport/jquery.wordexport.js"></script>

<script src="http://cdnjs.cloudflare.com/ajax/libs/summernote/0.6.4/summernote.min.js"></script>

<script type="text/javascript">
$("#original").hide();
$("#summernote").summernote({
onChange: function(contents) {
socket.emit('update', contents);
var no = $("#summernote").code();
}
});

socket.on('update', function(msg) {
  $('.note-editable').html(msg);
  $('.note-editable').focus();
});

$("#nombre").change(function(){
nombredoc = $("#nombre").val();
});

function myFunction() {
$("#original").html($("#summernote").code());
$("#original").wordExport(nombredoc);
}
</script>
</body>
</html>
